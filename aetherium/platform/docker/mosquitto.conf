# Eclipse Mosquitto MQTT Broker Configuration
# for Quantum AI Platform IoT Integration

# =================================================================
# General configuration
# =================================================================

# Run as daemon
#daemon true

# PID file
#pid_file /var/run/mosquitto.pid

# User to run as
#user mosquitto

# Maximum number of client connections
max_connections 1000

# =================================================================
# Default listener
# =================================================================

# Port to use for the default listener
port 1883

# Bind address for default listener
bind_address 0.0.0.0

# Maximum QoS level
max_queued_messages 1000

# Message size limit (bytes)
message_size_limit 268435456

# =================================================================
# WebSockets listener
# =================================================================

# WebSockets support for web clients
listener 9001
protocol websockets
bind_address 0.0.0.0

# =================================================================
# Security
# =================================================================

# Allow anonymous connections (disable in production)
allow_anonymous true

# Require clients to provide username/password
#require_certificate false

# Password file (create with mosquitto_passwd)
#password_file /etc/mosquitto/passwd

# ACL file for topic-based access control
#acl_file /etc/mosquitto/acl

# =================================================================
# Persistence
# =================================================================

# Enable persistence
persistence true

# Persistence location
persistence_location /mosquitto/data/

# How often to save persistent data (seconds)
autosave_interval 1800

# Save retained messages to disk
retained_persistence true

# =================================================================
# Logging
# =================================================================

# Log destinations
log_dest stdout
log_dest file /mosquitto/log/mosquitto.log

# Log types
log_type error
log_type warning
log_type notice
log_type information
#log_type debug

# Timestamp logging
log_timestamp true

# Connection logging
connection_messages true

# =================================================================
# System performance
# =================================================================

# Maximum inflight messages per client
max_inflight_messages 20

# Maximum QoS 1 and 2 messages in the outgoing queue
max_queued_messages 1000

# Upgrade QoS if requested QoS is not available
upgrade_outgoing_qos false

# =================================================================
# Quantum AI Platform specific topics
# =================================================================

# Topic patterns for different system components:
# - quantum/+/status          : Quantum device status
# - quantum/+/circuits/+      : Quantum circuit data
# - quantum/+/results/+       : Execution results
# - timecrystal/+/state       : Time crystal states
# - timecrystal/+/sync        : Synchronization events
# - neuromorphic/+/spikes     : Neural spike events
# - neuromorphic/+/networks   : Network status
# - iot/devices/+/status      : IoT device status
# - iot/devices/+/data        : Sensor data
# - iot/devices/+/control     : Control commands
# - system/health             : System health status
# - system/metrics            : Performance metrics
# - system/alerts             : System alerts

# =================================================================
# Bridge configuration (for external brokers)
# =================================================================

# Connection to external MQTT brokers if needed
#connection bridge-01
#address external-broker.example.com:1883
#topic quantum/# in 0
#topic iot/# both 0

# =================================================================
# Plugin configuration
# =================================================================

# Authentication plugin (if using custom auth)
#auth_plugin /usr/lib/mosquitto/mosquitto_auth.so
#auth_opt_backends postgres
#auth_opt_host postgres
#auth_opt_port 5432
#auth_opt_dbname quantumai_db
#auth_opt_user quantumai
#auth_opt_pass password

# =================================================================
# Advanced options
# =================================================================

# Maximum packet size
max_packet_size 268435456

# Client keepalive
keepalive_interval 60

# Retry interval for QoS > 0 messages
retry_interval 20

# Store QoS > 0 messages on disk
queue_qos0_messages true

# Memory limit (bytes)
memory_limit 268435456

# Enable per client message limits
per_listener_settings false

# =================================================================
# TLS/SSL Configuration (uncomment for secure connections)
# =================================================================

#listener 8883
#cafile /etc/mosquitto/certs/ca.crt
#certfile /etc/mosquitto/certs/server.crt
#keyfile /etc/mosquitto/certs/server.key
#tls_version tlsv1.2
#require_certificate true
#use_identity_as_username false

# =================================================================
# Health monitoring
# =================================================================

# Enable health monitoring endpoint
# This allows health checks via HTTP GET to /health
#health_check_interval 30